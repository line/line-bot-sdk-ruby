#!/usr/bin/env ruby

require_relative '../lib/line/client/version'

clients = [
  'channel-access-token',
  'insight',
  'liff',
  'manage-audience',
  'messaging-api',
  'module-attach',
  'module',
  'shop',
  'webhook'
]

def to_pascal_case(str)
  str.split('-').map(&:capitalize).join
end

clients.each do |client|
  command = "openapi-generator generate \
    -i line-openapi/#{client}.yml \
    -g ruby \
    -t src/main/resources/ruby-client \
    -o lib/clients/#{client} \
    --additional-properties=moduleName=LINE::Client::#{to_pascal_case(client)} \
    --additional-properties=gemVersion=#{ENV.fetch('GEM_VERSION')} \
    --http-user-agent LINE-BotSDK-Ruby/#{ENV.fetch('GEM_VERSION')}"
  system(command, exception: true)
end
